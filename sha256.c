#include <stdint.h>
#include <stdio.h>
#include <memory.h>
#include <arpa/inet.h>

void SHA256(uint8_t block[64], uint8_t digest[32]);

int main(int argc, char* argv[])
{
	uint8_t block[64] = {
			0,    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0,    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0,    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
		};

	uint8_t random[32] = {
			 0, 0, 0, 0,
			 255, 255, 0, 0,
			 31, 255, 251, 0,
			 144, 102, 121, 0,
			 196, 134, 225, 1,
			 225, 189, 25, 150,
			 117, 4, 145, 146,
			 247, 128, 22, 5

			//0, 0, 0, 0, 217, 1, 0, 0, 76, 255, 82, 0, 105, 148, 116, 0,
			//97, 153, 180, 39, 125, 197, 47, 131, 146, 45, 221, 62, 181, 254, 194, 157,

			//0x32, 0xc7, 0xdd, 0x4d, 0xa0, 0xd6, 0x1c, 0x46, 0xfd, 0x5f, 0x44, 0x49, 0x2c, 0x11, 0xff, 0x8a,
			//0x87, 0x77, 0xcb, 0x13, 0x4f, 0x95, 0xb1, 0x64, 0xc6, 0xde, 0x4e, 0x9f, 0xfc, 0xbb, 0x5f, 0x0f
		};

	uint8_t result[32];
	//memcpy(block, zeros, 32);
	//SHA256(block, result);
	//for (size_t i = 0; i < 32; ++i)
	//{
	//	printf("%02x", result[i]);
	//}
	//printf("\n");

	//memcpy(block, random, 32);
	SHA256(block, result);
	for (size_t i = 0; i < 32; ++i)
	{
		printf("%02x", result[i]);
	}
	printf("\n");

	return 0;
}

static inline void be32enc(void* dst, const void* src, size_t len)
{
	uint32_t* s;
	uint32_t* d;
	for (d=(uint32_t*)dst,s=(uint32_t*)src;len--;*d++=htonl(*s++));
}

void SHA256(uint8_t block[64], uint8_t digest[32])
{
	uint32_t state[8] = {
		0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19,
	};

	uint32_t W[64];
	be32enc(W, block, 16);

	for (int i = 16; i < 64; i++)
	{
		W[i] = (((W[i - 2] >> 17) | (W[i - 2] << 15)) ^ ((W[i - 2] >> 19) | (W[i - 2] << 13)) ^ (W[i - 2] >> 10)) + W[i - 7] + (((W[i - 15] >> 7) | (W[i - 15] << 25)) ^ ((W[i - 15] >> 18) | (W[i - 15] << 14)) ^ (W[i - 15] >> 3)) + W[i - 16];
	}

	uint32_t S[8];
	memcpy(S, state, sizeof(S));

	uint32_t t0, t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[0] + 0x428a2f98;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[1] + 0x71374491;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[2] + 0xb5c0fbcf;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[3] + 0xe9b5dba5;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[4] + 0x3956c25b;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[5] + 0x59f111f1;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[6] + 0x923f82a4;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[7] + 0xab1c5ed5;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[8] + 0xd807aa98;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[9] + 0x12835b01;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[10] + 0x243185be;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[11] + 0x550c7dc3;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[12] + 0x72be5d74;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[13] + 0x80deb1fe;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[14] + 0x9bdc06a7;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[15] + 0xc19bf174;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[16] + 0xe49b69c1;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[17] + 0xefbe4786;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[18] + 0x0fc19dc6;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[19] + 0x240ca1cc;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[20] + 0x2de92c6f;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[21] + 0x4a7484aa;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[22] + 0x5cb0a9dc;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[23] + 0x76f988da;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[24] + 0x983e5152;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[25] + 0xa831c66d;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[26] + 0xb00327c8;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[27] + 0xbf597fc7;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[28] + 0xc6e00bf3;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[29] + 0xd5a79147;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[30] + 0x06ca6351;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[31] + 0x14292967;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[32] + 0x27b70a85;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[33] + 0x2e1b2138;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[34] + 0x4d2c6dfc;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[35] + 0x53380d13;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[36] + 0x650a7354;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[37] + 0x766a0abb;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[38] + 0x81c2c92e;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[39] + 0x92722c85;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[40] + 0xa2bfe8a1;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[41] + 0xa81a664b;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[42] + 0xc24b8b70;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[43] + 0xc76c51a3;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[44] + 0xd192e819;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[45] + 0xd6990624;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[46] + 0xf40e3585;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[47] + 0x106aa070;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[48] + 0x19a4c116;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[49] + 0x1e376c08;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[50] + 0x2748774c;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[51] + 0x34b0bcb5;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[52] + 0x391c0cb3;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[53] + 0x4ed8aa4a;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[54] + 0x5b9cca4f;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[55] + 0x682e6ff3;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;
	t0 = S[7] + (((S[4] >> 6) | (S[4] << 26)) ^ ((S[4] >> 11) | (S[4] << 21)) ^ ((S[4] >> 25) | (S[4] << 7))) + ((S[4] & (S[5] ^ S[6])) ^ S[6]) + W[56] + 0x748f82ee;
	t1 = (((S[0] >> 2) | (S[0] << 30)) ^ ((S[0] >> 13) | (S[0] << 19)) ^ ((S[0] >> 22) | (S[0] << 10))) + ((S[0] & (S[1] | S[2])) | (S[1] & S[2]));
	S[3] += t0;
	S[7] = t0 + t1;
	t0 = S[6] + (((S[3] >> 6) | (S[3] << 26)) ^ ((S[3] >> 11) | (S[3] << 21)) ^ ((S[3] >> 25) | (S[3] << 7))) + ((S[3] & (S[4] ^ S[5])) ^ S[5]) + W[57] + 0x78a5636f;
	t1 = (((S[7] >> 2) | (S[7] << 30)) ^ ((S[7] >> 13) | (S[7] << 19)) ^ ((S[7] >> 22) | (S[7] << 10))) + ((S[7] & (S[0] | S[1])) | (S[0] & S[1]));
	S[2] += t0;
	S[6] = t0 + t1;
	t0 = S[5] + (((S[2] >> 6) | (S[2] << 26)) ^ ((S[2] >> 11) | (S[2] << 21)) ^ ((S[2] >> 25) | (S[2] << 7))) + ((S[2] & (S[3] ^ S[4])) ^ S[4]) + W[58] + 0x84c87814;
	t1 = (((S[6] >> 2) | (S[6] << 30)) ^ ((S[6] >> 13) | (S[6] << 19)) ^ ((S[6] >> 22) | (S[6] << 10))) + ((S[6] & (S[7] | S[0])) | (S[7] & S[0]));
	S[1] += t0;
	S[5] = t0 + t1;
	t0 = S[4] + (((S[1] >> 6) | (S[1] << 26)) ^ ((S[1] >> 11) | (S[1] << 21)) ^ ((S[1] >> 25) | (S[1] << 7))) + ((S[1] & (S[2] ^ S[3])) ^ S[3]) + W[59] + 0x8cc70208;
	t1 = (((S[5] >> 2) | (S[5] << 30)) ^ ((S[5] >> 13) | (S[5] << 19)) ^ ((S[5] >> 22) | (S[5] << 10))) + ((S[5] & (S[6] | S[7])) | (S[6] & S[7]));
	S[0] += t0;
	S[4] = t0 + t1;
	t0 = S[3] + (((S[0] >> 6) | (S[0] << 26)) ^ ((S[0] >> 11) | (S[0] << 21)) ^ ((S[0] >> 25) | (S[0] << 7))) + ((S[0] & (S[1] ^ S[2])) ^ S[2]) + W[60] + 0x90befffa;
	t1 = (((S[4] >> 2) | (S[4] << 30)) ^ ((S[4] >> 13) | (S[4] << 19)) ^ ((S[4] >> 22) | (S[4] << 10))) + ((S[4] & (S[5] | S[6])) | (S[5] & S[6]));
	S[7] += t0;
	S[3] = t0 + t1;
	t0 = S[2] + (((S[7] >> 6) | (S[7] << 26)) ^ ((S[7] >> 11) | (S[7] << 21)) ^ ((S[7] >> 25) | (S[7] << 7))) + ((S[7] & (S[0] ^ S[1])) ^ S[1]) + W[61] + 0xa4506ceb;
	t1 = (((S[3] >> 2) | (S[3] << 30)) ^ ((S[3] >> 13) | (S[3] << 19)) ^ ((S[3] >> 22) | (S[3] << 10))) + ((S[3] & (S[4] | S[5])) | (S[4] & S[5]));
	S[6] += t0;
	S[2] = t0 + t1;
	t0 = S[1] + (((S[6] >> 6) | (S[6] << 26)) ^ ((S[6] >> 11) | (S[6] << 21)) ^ ((S[6] >> 25) | (S[6] << 7))) + ((S[6] & (S[7] ^ S[0])) ^ S[0]) + W[62] + 0xbef9a3f7;
	t1 = (((S[2] >> 2) | (S[2] << 30)) ^ ((S[2] >> 13) | (S[2] << 19)) ^ ((S[2] >> 22) | (S[2] << 10))) + ((S[2] & (S[3] | S[4])) | (S[3] & S[4]));
	S[5] += t0;
	S[1] = t0 + t1;
	t0 = S[0] + (((S[5] >> 6) | (S[5] << 26)) ^ ((S[5] >> 11) | (S[5] << 21)) ^ ((S[5] >> 25) | (S[5] << 7))) + ((S[5] & (S[6] ^ S[7])) ^ S[7]) + W[63] + 0xc67178f2;
	t1 = (((S[1] >> 2) | (S[1] << 30)) ^ ((S[1] >> 13) | (S[1] << 19)) ^ ((S[1] >> 22) | (S[1] << 10))) + ((S[1] & (S[2] | S[3])) | (S[2] & S[3]));
	S[4] += t0;
	S[0] = t0 + t1;

	for (int i = 0; i < 8; i++)
	{
		state[i] += S[i];
	}

	be32enc(digest, state, 8);
}

