#include <stdint.h>
#include <stdio.h>
#include <memory.h>
#include <arpa/inet.h>

void SHA256(uint8_t block[64], uint8_t digest[32]);

int main(int argc, char* argv[])
{
	uint8_t block[64] = {
			0,    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0,    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0,    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
		};

	uint8_t zeros[32] = {
			0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
			0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		};
	uint8_t random[32] = {
			0x32, 0xc7, 0xdd, 0x4d, 0xa0, 0xd6, 0x1c, 0x46, 0xfd, 0x5f, 0x44, 0x49, 0x2c, 0x11, 0xff, 0x8a,
			0x87, 0x77, 0xcb, 0x13, 0x4f, 0x95, 0xb1, 0x64, 0xc6, 0xde, 0x4e, 0x9f, 0xfc, 0xbb, 0x5f, 0x0f
		};

	uint8_t result[32];
	memcpy(block, zeros, 32);
	SHA256(block, result);
	for (size_t i = 0; i < 32; ++i)
	{
		printf("%02x", result[i]);
	}
	printf("\n");

	memcpy(block, random, 32);
	SHA256(block, result);
	for (size_t i = 0; i < 32; ++i)
	{
		printf("%02x", result[i]);
	}
	printf("\n");

	return 0;
}

static inline void be32enc(void* dst, const void* src, size_t len)
{
	uint32_t* s;
	uint32_t* d;
	for (d=(uint32_t*)dst,s=(uint32_t*)src;len--;*d++=htonl(*s++));
}

void SHA256(uint8_t block[64], uint8_t digest[32])
{
	uint32_t state[8] = {
		0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19,
	};

	uint32_t W[64];
	be32enc(W, block, 16);

	for (int i = 16; i < 64; i++)
	{
		W[i] = (((W[i - 2] >> 17) | (W[i - 2] << 15)) ^ ((W[i - 2] >> 19) | (W[i - 2] << 13)) ^ (W[i - 2] >> 10)) + W[i - 7] + (((W[i - 15] >> 7) | (W[i - 15] << 25)) ^ ((W[i - 15] >> 18) | (W[i - 15] << 14)) ^ (W[i - 15] >> 3)) + W[i - 16];
	}

	uint32_t S[8];
	memcpy(S, state, sizeof(S));

	uint32_t t0, t1;
	t0 = S[71 % 8] + (((S[68 % 8] >> 6) | (S[68 % 8] << 26)) ^ ((S[68 % 8] >> 11) | (S[68 % 8] << 21)) ^ ((S[68 % 8] >> 25) | (S[68 % 8] << 7))) + ((S[68 % 8] & (S[69 % 8] ^ S[70 % 8])) ^ S[70 % 8]) + W[ 0] + 0x428a2f98;
	t1 = (((S[64 % 8] >> 2) | (S[64 % 8] << 30)) ^ ((S[64 % 8] >> 13) | (S[64 % 8] << 19)) ^ ((S[64 % 8] >> 22) | (S[64 % 8] << 10))) + ((S[64 % 8] & (S[65 % 8] | S[66 % 8])) | (S[65 % 8] & S[66 % 8]));
	S[67 % 8] += t0;
	S[71 % 8] = t0 + t1;
	t0 = S[70 % 8] + (((S[67 % 8] >> 6) | (S[67 % 8] << 26)) ^ ((S[67 % 8] >> 11) | (S[67 % 8] << 21)) ^ ((S[67 % 8] >> 25) | (S[67 % 8] << 7))) + ((S[67 % 8] & (S[68 % 8] ^ S[69 % 8])) ^ S[69 % 8]) + W[ 1] + 0x71374491;
	t1 = (((S[63 % 8] >> 2) | (S[63 % 8] << 30)) ^ ((S[63 % 8] >> 13) | (S[63 % 8] << 19)) ^ ((S[63 % 8] >> 22) | (S[63 % 8] << 10))) + ((S[63 % 8] & (S[64 % 8] | S[65 % 8])) | (S[64 % 8] & S[65 % 8]));
	S[66 % 8] += t0;
	S[70 % 8] = t0 + t1;
	t0 = S[69 % 8] + (((S[66 % 8] >> 6) | (S[66 % 8] << 26)) ^ ((S[66 % 8] >> 11) | (S[66 % 8] << 21)) ^ ((S[66 % 8] >> 25) | (S[66 % 8] << 7))) + ((S[66 % 8] & (S[67 % 8] ^ S[68 % 8])) ^ S[68 % 8]) + W[ 2] + 0xb5c0fbcf;
	t1 = (((S[62 % 8] >> 2) | (S[62 % 8] << 30)) ^ ((S[62 % 8] >> 13) | (S[62 % 8] << 19)) ^ ((S[62 % 8] >> 22) | (S[62 % 8] << 10))) + ((S[62 % 8] & (S[63 % 8] | S[64 % 8])) | (S[63 % 8] & S[64 % 8]));
	S[65 % 8] += t0;
	S[69 % 8] = t0 + t1;
	t0 = S[68 % 8] + (((S[65 % 8] >> 6) | (S[65 % 8] << 26)) ^ ((S[65 % 8] >> 11) | (S[65 % 8] << 21)) ^ ((S[65 % 8] >> 25) | (S[65 % 8] << 7))) + ((S[65 % 8] & (S[66 % 8] ^ S[67 % 8])) ^ S[67 % 8]) + W[ 3] + 0xe9b5dba5;
	t1 = (((S[61 % 8] >> 2) | (S[61 % 8] << 30)) ^ ((S[61 % 8] >> 13) | (S[61 % 8] << 19)) ^ ((S[61 % 8] >> 22) | (S[61 % 8] << 10))) + ((S[61 % 8] & (S[62 % 8] | S[63 % 8])) | (S[62 % 8] & S[63 % 8]));
	S[64 % 8] += t0;
	S[68 % 8] = t0 + t1;
	t0 = S[67 % 8] + (((S[64 % 8] >> 6) | (S[64 % 8] << 26)) ^ ((S[64 % 8] >> 11) | (S[64 % 8] << 21)) ^ ((S[64 % 8] >> 25) | (S[64 % 8] << 7))) + ((S[64 % 8] & (S[65 % 8] ^ S[66 % 8])) ^ S[66 % 8]) + W[ 4] + 0x3956c25b;
	t1 = (((S[60 % 8] >> 2) | (S[60 % 8] << 30)) ^ ((S[60 % 8] >> 13) | (S[60 % 8] << 19)) ^ ((S[60 % 8] >> 22) | (S[60 % 8] << 10))) + ((S[60 % 8] & (S[61 % 8] | S[62 % 8])) | (S[61 % 8] & S[62 % 8]));
	S[63 % 8] += t0;
	S[67 % 8] = t0 + t1;
	t0 = S[66 % 8] + (((S[63 % 8] >> 6) | (S[63 % 8] << 26)) ^ ((S[63 % 8] >> 11) | (S[63 % 8] << 21)) ^ ((S[63 % 8] >> 25) | (S[63 % 8] << 7))) + ((S[63 % 8] & (S[64 % 8] ^ S[65 % 8])) ^ S[65 % 8]) + W[ 5] + 0x59f111f1;
	t1 = (((S[59 % 8] >> 2) | (S[59 % 8] << 30)) ^ ((S[59 % 8] >> 13) | (S[59 % 8] << 19)) ^ ((S[59 % 8] >> 22) | (S[59 % 8] << 10))) + ((S[59 % 8] & (S[60 % 8] | S[61 % 8])) | (S[60 % 8] & S[61 % 8]));
	S[62 % 8] += t0;
	S[66 % 8] = t0 + t1;
	t0 = S[65 % 8] + (((S[62 % 8] >> 6) | (S[62 % 8] << 26)) ^ ((S[62 % 8] >> 11) | (S[62 % 8] << 21)) ^ ((S[62 % 8] >> 25) | (S[62 % 8] << 7))) + ((S[62 % 8] & (S[63 % 8] ^ S[64 % 8])) ^ S[64 % 8]) + W[ 6] + 0x923f82a4;
	t1 = (((S[58 % 8] >> 2) | (S[58 % 8] << 30)) ^ ((S[58 % 8] >> 13) | (S[58 % 8] << 19)) ^ ((S[58 % 8] >> 22) | (S[58 % 8] << 10))) + ((S[58 % 8] & (S[59 % 8] | S[60 % 8])) | (S[59 % 8] & S[60 % 8]));
	S[61 % 8] += t0;
	S[65 % 8] = t0 + t1;
	t0 = S[64 % 8] + (((S[61 % 8] >> 6) | (S[61 % 8] << 26)) ^ ((S[61 % 8] >> 11) | (S[61 % 8] << 21)) ^ ((S[61 % 8] >> 25) | (S[61 % 8] << 7))) + ((S[61 % 8] & (S[62 % 8] ^ S[63 % 8])) ^ S[63 % 8]) + W[ 7] + 0xab1c5ed5;
	t1 = (((S[57 % 8] >> 2) | (S[57 % 8] << 30)) ^ ((S[57 % 8] >> 13) | (S[57 % 8] << 19)) ^ ((S[57 % 8] >> 22) | (S[57 % 8] << 10))) + ((S[57 % 8] & (S[58 % 8] | S[59 % 8])) | (S[58 % 8] & S[59 % 8]));
	S[60 % 8] += t0;
	S[64 % 8] = t0 + t1;
	t0 = S[63 % 8] + (((S[60 % 8] >> 6) | (S[60 % 8] << 26)) ^ ((S[60 % 8] >> 11) | (S[60 % 8] << 21)) ^ ((S[60 % 8] >> 25) | (S[60 % 8] << 7))) + ((S[60 % 8] & (S[61 % 8] ^ S[62 % 8])) ^ S[62 % 8]) + W[ 8] + 0xd807aa98;
	t1 = (((S[56 % 8] >> 2) | (S[56 % 8] << 30)) ^ ((S[56 % 8] >> 13) | (S[56 % 8] << 19)) ^ ((S[56 % 8] >> 22) | (S[56 % 8] << 10))) + ((S[56 % 8] & (S[57 % 8] | S[58 % 8])) | (S[57 % 8] & S[58 % 8]));
	S[59 % 8] += t0;
	S[63 % 8] = t0 + t1;
	t0 = S[62 % 8] + (((S[59 % 8] >> 6) | (S[59 % 8] << 26)) ^ ((S[59 % 8] >> 11) | (S[59 % 8] << 21)) ^ ((S[59 % 8] >> 25) | (S[59 % 8] << 7))) + ((S[59 % 8] & (S[60 % 8] ^ S[61 % 8])) ^ S[61 % 8]) + W[ 9] + 0x12835b01;
	t1 = (((S[55 % 8] >> 2) | (S[55 % 8] << 30)) ^ ((S[55 % 8] >> 13) | (S[55 % 8] << 19)) ^ ((S[55 % 8] >> 22) | (S[55 % 8] << 10))) + ((S[55 % 8] & (S[56 % 8] | S[57 % 8])) | (S[56 % 8] & S[57 % 8]));
	S[58 % 8] += t0;
	S[62 % 8] = t0 + t1;
	t0 = S[61 % 8] + (((S[58 % 8] >> 6) | (S[58 % 8] << 26)) ^ ((S[58 % 8] >> 11) | (S[58 % 8] << 21)) ^ ((S[58 % 8] >> 25) | (S[58 % 8] << 7))) + ((S[58 % 8] & (S[59 % 8] ^ S[60 % 8])) ^ S[60 % 8]) + W[10] + 0x243185be;
	t1 = (((S[54 % 8] >> 2) | (S[54 % 8] << 30)) ^ ((S[54 % 8] >> 13) | (S[54 % 8] << 19)) ^ ((S[54 % 8] >> 22) | (S[54 % 8] << 10))) + ((S[54 % 8] & (S[55 % 8] | S[56 % 8])) | (S[55 % 8] & S[56 % 8]));
	S[57 % 8] += t0;
	S[61 % 8] = t0 + t1;
	t0 = S[60 % 8] + (((S[57 % 8] >> 6) | (S[57 % 8] << 26)) ^ ((S[57 % 8] >> 11) | (S[57 % 8] << 21)) ^ ((S[57 % 8] >> 25) | (S[57 % 8] << 7))) + ((S[57 % 8] & (S[58 % 8] ^ S[59 % 8])) ^ S[59 % 8]) + W[11] + 0x550c7dc3;
	t1 = (((S[53 % 8] >> 2) | (S[53 % 8] << 30)) ^ ((S[53 % 8] >> 13) | (S[53 % 8] << 19)) ^ ((S[53 % 8] >> 22) | (S[53 % 8] << 10))) + ((S[53 % 8] & (S[54 % 8] | S[55 % 8])) | (S[54 % 8] & S[55 % 8]));
	S[56 % 8] += t0;
	S[60 % 8] = t0 + t1;
	t0 = S[59 % 8] + (((S[56 % 8] >> 6) | (S[56 % 8] << 26)) ^ ((S[56 % 8] >> 11) | (S[56 % 8] << 21)) ^ ((S[56 % 8] >> 25) | (S[56 % 8] << 7))) + ((S[56 % 8] & (S[57 % 8] ^ S[58 % 8])) ^ S[58 % 8]) + W[12] + 0x72be5d74;
	t1 = (((S[52 % 8] >> 2) | (S[52 % 8] << 30)) ^ ((S[52 % 8] >> 13) | (S[52 % 8] << 19)) ^ ((S[52 % 8] >> 22) | (S[52 % 8] << 10))) + ((S[52 % 8] & (S[53 % 8] | S[54 % 8])) | (S[53 % 8] & S[54 % 8]));
	S[55 % 8] += t0;
	S[59 % 8] = t0 + t1;
	t0 = S[58 % 8] + (((S[55 % 8] >> 6) | (S[55 % 8] << 26)) ^ ((S[55 % 8] >> 11) | (S[55 % 8] << 21)) ^ ((S[55 % 8] >> 25) | (S[55 % 8] << 7))) + ((S[55 % 8] & (S[56 % 8] ^ S[57 % 8])) ^ S[57 % 8]) + W[13] + 0x80deb1fe;
	t1 = (((S[51 % 8] >> 2) | (S[51 % 8] << 30)) ^ ((S[51 % 8] >> 13) | (S[51 % 8] << 19)) ^ ((S[51 % 8] >> 22) | (S[51 % 8] << 10))) + ((S[51 % 8] & (S[52 % 8] | S[53 % 8])) | (S[52 % 8] & S[53 % 8]));
	S[54 % 8] += t0;
	S[58 % 8] = t0 + t1;
	t0 = S[57 % 8] + (((S[54 % 8] >> 6) | (S[54 % 8] << 26)) ^ ((S[54 % 8] >> 11) | (S[54 % 8] << 21)) ^ ((S[54 % 8] >> 25) | (S[54 % 8] << 7))) + ((S[54 % 8] & (S[55 % 8] ^ S[56 % 8])) ^ S[56 % 8]) + W[14] + 0x9bdc06a7;
	t1 = (((S[50 % 8] >> 2) | (S[50 % 8] << 30)) ^ ((S[50 % 8] >> 13) | (S[50 % 8] << 19)) ^ ((S[50 % 8] >> 22) | (S[50 % 8] << 10))) + ((S[50 % 8] & (S[51 % 8] | S[52 % 8])) | (S[51 % 8] & S[52 % 8]));
	S[53 % 8] += t0;
	S[57 % 8] = t0 + t1;
	t0 = S[56 % 8] + (((S[53 % 8] >> 6) | (S[53 % 8] << 26)) ^ ((S[53 % 8] >> 11) | (S[53 % 8] << 21)) ^ ((S[53 % 8] >> 25) | (S[53 % 8] << 7))) + ((S[53 % 8] & (S[54 % 8] ^ S[55 % 8])) ^ S[55 % 8]) + W[15] + 0xc19bf174;
	t1 = (((S[49 % 8] >> 2) | (S[49 % 8] << 30)) ^ ((S[49 % 8] >> 13) | (S[49 % 8] << 19)) ^ ((S[49 % 8] >> 22) | (S[49 % 8] << 10))) + ((S[49 % 8] & (S[50 % 8] | S[51 % 8])) | (S[50 % 8] & S[51 % 8]));
	S[52 % 8] += t0;
	S[56 % 8] = t0 + t1;
	t0 = S[55 % 8] + (((S[52 % 8] >> 6) | (S[52 % 8] << 26)) ^ ((S[52 % 8] >> 11) | (S[52 % 8] << 21)) ^ ((S[52 % 8] >> 25) | (S[52 % 8] << 7))) + ((S[52 % 8] & (S[53 % 8] ^ S[54 % 8])) ^ S[54 % 8]) + W[16] + 0xe49b69c1;
	t1 = (((S[48 % 8] >> 2) | (S[48 % 8] << 30)) ^ ((S[48 % 8] >> 13) | (S[48 % 8] << 19)) ^ ((S[48 % 8] >> 22) | (S[48 % 8] << 10))) + ((S[48 % 8] & (S[49 % 8] | S[50 % 8])) | (S[49 % 8] & S[50 % 8]));
	S[51 % 8] += t0;
	S[55 % 8] = t0 + t1;
	t0 = S[54 % 8] + (((S[51 % 8] >> 6) | (S[51 % 8] << 26)) ^ ((S[51 % 8] >> 11) | (S[51 % 8] << 21)) ^ ((S[51 % 8] >> 25) | (S[51 % 8] << 7))) + ((S[51 % 8] & (S[52 % 8] ^ S[53 % 8])) ^ S[53 % 8]) + W[17] + 0xefbe4786;
	t1 = (((S[47 % 8] >> 2) | (S[47 % 8] << 30)) ^ ((S[47 % 8] >> 13) | (S[47 % 8] << 19)) ^ ((S[47 % 8] >> 22) | (S[47 % 8] << 10))) + ((S[47 % 8] & (S[48 % 8] | S[49 % 8])) | (S[48 % 8] & S[49 % 8]));
	S[50 % 8] += t0;
	S[54 % 8] = t0 + t1;
	t0 = S[53 % 8] + (((S[50 % 8] >> 6) | (S[50 % 8] << 26)) ^ ((S[50 % 8] >> 11) | (S[50 % 8] << 21)) ^ ((S[50 % 8] >> 25) | (S[50 % 8] << 7))) + ((S[50 % 8] & (S[51 % 8] ^ S[52 % 8])) ^ S[52 % 8]) + W[18] + 0x0fc19dc6;
	t1 = (((S[46 % 8] >> 2) | (S[46 % 8] << 30)) ^ ((S[46 % 8] >> 13) | (S[46 % 8] << 19)) ^ ((S[46 % 8] >> 22) | (S[46 % 8] << 10))) + ((S[46 % 8] & (S[47 % 8] | S[48 % 8])) | (S[47 % 8] & S[48 % 8]));
	S[49 % 8] += t0;
	S[53 % 8] = t0 + t1;
	t0 = S[52 % 8] + (((S[49 % 8] >> 6) | (S[49 % 8] << 26)) ^ ((S[49 % 8] >> 11) | (S[49 % 8] << 21)) ^ ((S[49 % 8] >> 25) | (S[49 % 8] << 7))) + ((S[49 % 8] & (S[50 % 8] ^ S[51 % 8])) ^ S[51 % 8]) + W[19] + 0x240ca1cc;
	t1 = (((S[45 % 8] >> 2) | (S[45 % 8] << 30)) ^ ((S[45 % 8] >> 13) | (S[45 % 8] << 19)) ^ ((S[45 % 8] >> 22) | (S[45 % 8] << 10))) + ((S[45 % 8] & (S[46 % 8] | S[47 % 8])) | (S[46 % 8] & S[47 % 8]));
	S[48 % 8] += t0;
	S[52 % 8] = t0 + t1;
	t0 = S[51 % 8] + (((S[48 % 8] >> 6) | (S[48 % 8] << 26)) ^ ((S[48 % 8] >> 11) | (S[48 % 8] << 21)) ^ ((S[48 % 8] >> 25) | (S[48 % 8] << 7))) + ((S[48 % 8] & (S[49 % 8] ^ S[50 % 8])) ^ S[50 % 8]) + W[20] + 0x2de92c6f;
	t1 = (((S[44 % 8] >> 2) | (S[44 % 8] << 30)) ^ ((S[44 % 8] >> 13) | (S[44 % 8] << 19)) ^ ((S[44 % 8] >> 22) | (S[44 % 8] << 10))) + ((S[44 % 8] & (S[45 % 8] | S[46 % 8])) | (S[45 % 8] & S[46 % 8]));
	S[47 % 8] += t0;
	S[51 % 8] = t0 + t1;
	t0 = S[50 % 8] + (((S[47 % 8] >> 6) | (S[47 % 8] << 26)) ^ ((S[47 % 8] >> 11) | (S[47 % 8] << 21)) ^ ((S[47 % 8] >> 25) | (S[47 % 8] << 7))) + ((S[47 % 8] & (S[48 % 8] ^ S[49 % 8])) ^ S[49 % 8]) + W[21] + 0x4a7484aa;
	t1 = (((S[43 % 8] >> 2) | (S[43 % 8] << 30)) ^ ((S[43 % 8] >> 13) | (S[43 % 8] << 19)) ^ ((S[43 % 8] >> 22) | (S[43 % 8] << 10))) + ((S[43 % 8] & (S[44 % 8] | S[45 % 8])) | (S[44 % 8] & S[45 % 8]));
	S[46 % 8] += t0;
	S[50 % 8] = t0 + t1;
	t0 = S[49 % 8] + (((S[46 % 8] >> 6) | (S[46 % 8] << 26)) ^ ((S[46 % 8] >> 11) | (S[46 % 8] << 21)) ^ ((S[46 % 8] >> 25) | (S[46 % 8] << 7))) + ((S[46 % 8] & (S[47 % 8] ^ S[48 % 8])) ^ S[48 % 8]) + W[22] + 0x5cb0a9dc;
	t1 = (((S[42 % 8] >> 2) | (S[42 % 8] << 30)) ^ ((S[42 % 8] >> 13) | (S[42 % 8] << 19)) ^ ((S[42 % 8] >> 22) | (S[42 % 8] << 10))) + ((S[42 % 8] & (S[43 % 8] | S[44 % 8])) | (S[43 % 8] & S[44 % 8]));
	S[45 % 8] += t0;
	S[49 % 8] = t0 + t1;
	t0 = S[48 % 8] + (((S[45 % 8] >> 6) | (S[45 % 8] << 26)) ^ ((S[45 % 8] >> 11) | (S[45 % 8] << 21)) ^ ((S[45 % 8] >> 25) | (S[45 % 8] << 7))) + ((S[45 % 8] & (S[46 % 8] ^ S[47 % 8])) ^ S[47 % 8]) + W[23] + 0x76f988da;
	t1 = (((S[41 % 8] >> 2) | (S[41 % 8] << 30)) ^ ((S[41 % 8] >> 13) | (S[41 % 8] << 19)) ^ ((S[41 % 8] >> 22) | (S[41 % 8] << 10))) + ((S[41 % 8] & (S[42 % 8] | S[43 % 8])) | (S[42 % 8] & S[43 % 8]));
	S[44 % 8] += t0;
	S[48 % 8] = t0 + t1;
	t0 = S[47 % 8] + (((S[44 % 8] >> 6) | (S[44 % 8] << 26)) ^ ((S[44 % 8] >> 11) | (S[44 % 8] << 21)) ^ ((S[44 % 8] >> 25) | (S[44 % 8] << 7))) + ((S[44 % 8] & (S[45 % 8] ^ S[46 % 8])) ^ S[46 % 8]) + W[24] + 0x983e5152;
	t1 = (((S[40 % 8] >> 2) | (S[40 % 8] << 30)) ^ ((S[40 % 8] >> 13) | (S[40 % 8] << 19)) ^ ((S[40 % 8] >> 22) | (S[40 % 8] << 10))) + ((S[40 % 8] & (S[41 % 8] | S[42 % 8])) | (S[41 % 8] & S[42 % 8]));
	S[43 % 8] += t0;
	S[47 % 8] = t0 + t1;
	t0 = S[46 % 8] + (((S[43 % 8] >> 6) | (S[43 % 8] << 26)) ^ ((S[43 % 8] >> 11) | (S[43 % 8] << 21)) ^ ((S[43 % 8] >> 25) | (S[43 % 8] << 7))) + ((S[43 % 8] & (S[44 % 8] ^ S[45 % 8])) ^ S[45 % 8]) + W[25] + 0xa831c66d;
	t1 = (((S[39 % 8] >> 2) | (S[39 % 8] << 30)) ^ ((S[39 % 8] >> 13) | (S[39 % 8] << 19)) ^ ((S[39 % 8] >> 22) | (S[39 % 8] << 10))) + ((S[39 % 8] & (S[40 % 8] | S[41 % 8])) | (S[40 % 8] & S[41 % 8]));
	S[42 % 8] += t0;
	S[46 % 8] = t0 + t1;
	t0 = S[45 % 8] + (((S[42 % 8] >> 6) | (S[42 % 8] << 26)) ^ ((S[42 % 8] >> 11) | (S[42 % 8] << 21)) ^ ((S[42 % 8] >> 25) | (S[42 % 8] << 7))) + ((S[42 % 8] & (S[43 % 8] ^ S[44 % 8])) ^ S[44 % 8]) + W[26] + 0xb00327c8;
	t1 = (((S[38 % 8] >> 2) | (S[38 % 8] << 30)) ^ ((S[38 % 8] >> 13) | (S[38 % 8] << 19)) ^ ((S[38 % 8] >> 22) | (S[38 % 8] << 10))) + ((S[38 % 8] & (S[39 % 8] | S[40 % 8])) | (S[39 % 8] & S[40 % 8]));
	S[41 % 8] += t0;
	S[45 % 8] = t0 + t1;
	t0 = S[44 % 8] + (((S[41 % 8] >> 6) | (S[41 % 8] << 26)) ^ ((S[41 % 8] >> 11) | (S[41 % 8] << 21)) ^ ((S[41 % 8] >> 25) | (S[41 % 8] << 7))) + ((S[41 % 8] & (S[42 % 8] ^ S[43 % 8])) ^ S[43 % 8]) + W[27] + 0xbf597fc7;
	t1 = (((S[37 % 8] >> 2) | (S[37 % 8] << 30)) ^ ((S[37 % 8] >> 13) | (S[37 % 8] << 19)) ^ ((S[37 % 8] >> 22) | (S[37 % 8] << 10))) + ((S[37 % 8] & (S[38 % 8] | S[39 % 8])) | (S[38 % 8] & S[39 % 8]));
	S[40 % 8] += t0;
	S[44 % 8] = t0 + t1;
	t0 = S[43 % 8] + (((S[40 % 8] >> 6) | (S[40 % 8] << 26)) ^ ((S[40 % 8] >> 11) | (S[40 % 8] << 21)) ^ ((S[40 % 8] >> 25) | (S[40 % 8] << 7))) + ((S[40 % 8] & (S[41 % 8] ^ S[42 % 8])) ^ S[42 % 8]) + W[28] + 0xc6e00bf3;
	t1 = (((S[36 % 8] >> 2) | (S[36 % 8] << 30)) ^ ((S[36 % 8] >> 13) | (S[36 % 8] << 19)) ^ ((S[36 % 8] >> 22) | (S[36 % 8] << 10))) + ((S[36 % 8] & (S[37 % 8] | S[38 % 8])) | (S[37 % 8] & S[38 % 8]));
	S[39 % 8] += t0;
	S[43 % 8] = t0 + t1;
	t0 = S[42 % 8] + (((S[39 % 8] >> 6) | (S[39 % 8] << 26)) ^ ((S[39 % 8] >> 11) | (S[39 % 8] << 21)) ^ ((S[39 % 8] >> 25) | (S[39 % 8] << 7))) + ((S[39 % 8] & (S[40 % 8] ^ S[41 % 8])) ^ S[41 % 8]) + W[29] + 0xd5a79147;
	t1 = (((S[35 % 8] >> 2) | (S[35 % 8] << 30)) ^ ((S[35 % 8] >> 13) | (S[35 % 8] << 19)) ^ ((S[35 % 8] >> 22) | (S[35 % 8] << 10))) + ((S[35 % 8] & (S[36 % 8] | S[37 % 8])) | (S[36 % 8] & S[37 % 8]));
	S[38 % 8] += t0;
	S[42 % 8] = t0 + t1;
	t0 = S[41 % 8] + (((S[38 % 8] >> 6) | (S[38 % 8] << 26)) ^ ((S[38 % 8] >> 11) | (S[38 % 8] << 21)) ^ ((S[38 % 8] >> 25) | (S[38 % 8] << 7))) + ((S[38 % 8] & (S[39 % 8] ^ S[40 % 8])) ^ S[40 % 8]) + W[30] + 0x06ca6351;
	t1 = (((S[34 % 8] >> 2) | (S[34 % 8] << 30)) ^ ((S[34 % 8] >> 13) | (S[34 % 8] << 19)) ^ ((S[34 % 8] >> 22) | (S[34 % 8] << 10))) + ((S[34 % 8] & (S[35 % 8] | S[36 % 8])) | (S[35 % 8] & S[36 % 8]));
	S[37 % 8] += t0;
	S[41 % 8] = t0 + t1;
	t0 = S[40 % 8] + (((S[37 % 8] >> 6) | (S[37 % 8] << 26)) ^ ((S[37 % 8] >> 11) | (S[37 % 8] << 21)) ^ ((S[37 % 8] >> 25) | (S[37 % 8] << 7))) + ((S[37 % 8] & (S[38 % 8] ^ S[39 % 8])) ^ S[39 % 8]) + W[31] + 0x14292967;
	t1 = (((S[33 % 8] >> 2) | (S[33 % 8] << 30)) ^ ((S[33 % 8] >> 13) | (S[33 % 8] << 19)) ^ ((S[33 % 8] >> 22) | (S[33 % 8] << 10))) + ((S[33 % 8] & (S[34 % 8] | S[35 % 8])) | (S[34 % 8] & S[35 % 8]));
	S[36 % 8] += t0;
	S[40 % 8] = t0 + t1;
	t0 = S[39 % 8] + (((S[36 % 8] >> 6) | (S[36 % 8] << 26)) ^ ((S[36 % 8] >> 11) | (S[36 % 8] << 21)) ^ ((S[36 % 8] >> 25) | (S[36 % 8] << 7))) + ((S[36 % 8] & (S[37 % 8] ^ S[38 % 8])) ^ S[38 % 8]) + W[32] + 0x27b70a85;
	t1 = (((S[32 % 8] >> 2) | (S[32 % 8] << 30)) ^ ((S[32 % 8] >> 13) | (S[32 % 8] << 19)) ^ ((S[32 % 8] >> 22) | (S[32 % 8] << 10))) + ((S[32 % 8] & (S[33 % 8] | S[34 % 8])) | (S[33 % 8] & S[34 % 8]));
	S[35 % 8] += t0;
	S[39 % 8] = t0 + t1;
	t0 = S[38 % 8] + (((S[35 % 8] >> 6) | (S[35 % 8] << 26)) ^ ((S[35 % 8] >> 11) | (S[35 % 8] << 21)) ^ ((S[35 % 8] >> 25) | (S[35 % 8] << 7))) + ((S[35 % 8] & (S[36 % 8] ^ S[37 % 8])) ^ S[37 % 8]) + W[33] + 0x2e1b2138;
	t1 = (((S[31 % 8] >> 2) | (S[31 % 8] << 30)) ^ ((S[31 % 8] >> 13) | (S[31 % 8] << 19)) ^ ((S[31 % 8] >> 22) | (S[31 % 8] << 10))) + ((S[31 % 8] & (S[32 % 8] | S[33 % 8])) | (S[32 % 8] & S[33 % 8]));
	S[34 % 8] += t0;
	S[38 % 8] = t0 + t1;
	t0 = S[37 % 8] + (((S[34 % 8] >> 6) | (S[34 % 8] << 26)) ^ ((S[34 % 8] >> 11) | (S[34 % 8] << 21)) ^ ((S[34 % 8] >> 25) | (S[34 % 8] << 7))) + ((S[34 % 8] & (S[35 % 8] ^ S[36 % 8])) ^ S[36 % 8]) + W[34] + 0x4d2c6dfc;
	t1 = (((S[30 % 8] >> 2) | (S[30 % 8] << 30)) ^ ((S[30 % 8] >> 13) | (S[30 % 8] << 19)) ^ ((S[30 % 8] >> 22) | (S[30 % 8] << 10))) + ((S[30 % 8] & (S[31 % 8] | S[32 % 8])) | (S[31 % 8] & S[32 % 8]));
	S[33 % 8] += t0;
	S[37 % 8] = t0 + t1;
	t0 = S[36 % 8] + (((S[33 % 8] >> 6) | (S[33 % 8] << 26)) ^ ((S[33 % 8] >> 11) | (S[33 % 8] << 21)) ^ ((S[33 % 8] >> 25) | (S[33 % 8] << 7))) + ((S[33 % 8] & (S[34 % 8] ^ S[35 % 8])) ^ S[35 % 8]) + W[35] + 0x53380d13;
	t1 = (((S[29 % 8] >> 2) | (S[29 % 8] << 30)) ^ ((S[29 % 8] >> 13) | (S[29 % 8] << 19)) ^ ((S[29 % 8] >> 22) | (S[29 % 8] << 10))) + ((S[29 % 8] & (S[30 % 8] | S[31 % 8])) | (S[30 % 8] & S[31 % 8]));
	S[32 % 8] += t0;
	S[36 % 8] = t0 + t1;
	t0 = S[35 % 8] + (((S[32 % 8] >> 6) | (S[32 % 8] << 26)) ^ ((S[32 % 8] >> 11) | (S[32 % 8] << 21)) ^ ((S[32 % 8] >> 25) | (S[32 % 8] << 7))) + ((S[32 % 8] & (S[33 % 8] ^ S[34 % 8])) ^ S[34 % 8]) + W[36] + 0x650a7354;
	t1 = (((S[28 % 8] >> 2) | (S[28 % 8] << 30)) ^ ((S[28 % 8] >> 13) | (S[28 % 8] << 19)) ^ ((S[28 % 8] >> 22) | (S[28 % 8] << 10))) + ((S[28 % 8] & (S[29 % 8] | S[30 % 8])) | (S[29 % 8] & S[30 % 8]));
	S[31 % 8] += t0;
	S[35 % 8] = t0 + t1;
	t0 = S[34 % 8] + (((S[31 % 8] >> 6) | (S[31 % 8] << 26)) ^ ((S[31 % 8] >> 11) | (S[31 % 8] << 21)) ^ ((S[31 % 8] >> 25) | (S[31 % 8] << 7))) + ((S[31 % 8] & (S[32 % 8] ^ S[33 % 8])) ^ S[33 % 8]) + W[37] + 0x766a0abb;
	t1 = (((S[27 % 8] >> 2) | (S[27 % 8] << 30)) ^ ((S[27 % 8] >> 13) | (S[27 % 8] << 19)) ^ ((S[27 % 8] >> 22) | (S[27 % 8] << 10))) + ((S[27 % 8] & (S[28 % 8] | S[29 % 8])) | (S[28 % 8] & S[29 % 8]));
	S[30 % 8] += t0;
	S[34 % 8] = t0 + t1;
	t0 = S[33 % 8] + (((S[30 % 8] >> 6) | (S[30 % 8] << 26)) ^ ((S[30 % 8] >> 11) | (S[30 % 8] << 21)) ^ ((S[30 % 8] >> 25) | (S[30 % 8] << 7))) + ((S[30 % 8] & (S[31 % 8] ^ S[32 % 8])) ^ S[32 % 8]) + W[38] + 0x81c2c92e;
	t1 = (((S[26 % 8] >> 2) | (S[26 % 8] << 30)) ^ ((S[26 % 8] >> 13) | (S[26 % 8] << 19)) ^ ((S[26 % 8] >> 22) | (S[26 % 8] << 10))) + ((S[26 % 8] & (S[27 % 8] | S[28 % 8])) | (S[27 % 8] & S[28 % 8]));
	S[29 % 8] += t0;
	S[33 % 8] = t0 + t1;
	t0 = S[32 % 8] + (((S[29 % 8] >> 6) | (S[29 % 8] << 26)) ^ ((S[29 % 8] >> 11) | (S[29 % 8] << 21)) ^ ((S[29 % 8] >> 25) | (S[29 % 8] << 7))) + ((S[29 % 8] & (S[30 % 8] ^ S[31 % 8])) ^ S[31 % 8]) + W[39] + 0x92722c85;
	t1 = (((S[25 % 8] >> 2) | (S[25 % 8] << 30)) ^ ((S[25 % 8] >> 13) | (S[25 % 8] << 19)) ^ ((S[25 % 8] >> 22) | (S[25 % 8] << 10))) + ((S[25 % 8] & (S[26 % 8] | S[27 % 8])) | (S[26 % 8] & S[27 % 8]));
	S[28 % 8] += t0;
	S[32 % 8] = t0 + t1;
	t0 = S[31 % 8] + (((S[28 % 8] >> 6) | (S[28 % 8] << 26)) ^ ((S[28 % 8] >> 11) | (S[28 % 8] << 21)) ^ ((S[28 % 8] >> 25) | (S[28 % 8] << 7))) + ((S[28 % 8] & (S[29 % 8] ^ S[30 % 8])) ^ S[30 % 8]) + W[40] + 0xa2bfe8a1;
	t1 = (((S[24 % 8] >> 2) | (S[24 % 8] << 30)) ^ ((S[24 % 8] >> 13) | (S[24 % 8] << 19)) ^ ((S[24 % 8] >> 22) | (S[24 % 8] << 10))) + ((S[24 % 8] & (S[25 % 8] | S[26 % 8])) | (S[25 % 8] & S[26 % 8]));
	S[27 % 8] += t0;
	S[31 % 8] = t0 + t1;
	t0 = S[30 % 8] + (((S[27 % 8] >> 6) | (S[27 % 8] << 26)) ^ ((S[27 % 8] >> 11) | (S[27 % 8] << 21)) ^ ((S[27 % 8] >> 25) | (S[27 % 8] << 7))) + ((S[27 % 8] & (S[28 % 8] ^ S[29 % 8])) ^ S[29 % 8]) + W[41] + 0xa81a664b;
	t1 = (((S[23 % 8] >> 2) | (S[23 % 8] << 30)) ^ ((S[23 % 8] >> 13) | (S[23 % 8] << 19)) ^ ((S[23 % 8] >> 22) | (S[23 % 8] << 10))) + ((S[23 % 8] & (S[24 % 8] | S[25 % 8])) | (S[24 % 8] & S[25 % 8]));
	S[26 % 8] += t0;
	S[30 % 8] = t0 + t1;
	t0 = S[29 % 8] + (((S[26 % 8] >> 6) | (S[26 % 8] << 26)) ^ ((S[26 % 8] >> 11) | (S[26 % 8] << 21)) ^ ((S[26 % 8] >> 25) | (S[26 % 8] << 7))) + ((S[26 % 8] & (S[27 % 8] ^ S[28 % 8])) ^ S[28 % 8]) + W[42] + 0xc24b8b70;
	t1 = (((S[22 % 8] >> 2) | (S[22 % 8] << 30)) ^ ((S[22 % 8] >> 13) | (S[22 % 8] << 19)) ^ ((S[22 % 8] >> 22) | (S[22 % 8] << 10))) + ((S[22 % 8] & (S[23 % 8] | S[24 % 8])) | (S[23 % 8] & S[24 % 8]));
	S[25 % 8] += t0;
	S[29 % 8] = t0 + t1;
	t0 = S[28 % 8] + (((S[25 % 8] >> 6) | (S[25 % 8] << 26)) ^ ((S[25 % 8] >> 11) | (S[25 % 8] << 21)) ^ ((S[25 % 8] >> 25) | (S[25 % 8] << 7))) + ((S[25 % 8] & (S[26 % 8] ^ S[27 % 8])) ^ S[27 % 8]) + W[43] + 0xc76c51a3;
	t1 = (((S[21 % 8] >> 2) | (S[21 % 8] << 30)) ^ ((S[21 % 8] >> 13) | (S[21 % 8] << 19)) ^ ((S[21 % 8] >> 22) | (S[21 % 8] << 10))) + ((S[21 % 8] & (S[22 % 8] | S[23 % 8])) | (S[22 % 8] & S[23 % 8]));
	S[24 % 8] += t0;
	S[28 % 8] = t0 + t1;
	t0 = S[27 % 8] + (((S[24 % 8] >> 6) | (S[24 % 8] << 26)) ^ ((S[24 % 8] >> 11) | (S[24 % 8] << 21)) ^ ((S[24 % 8] >> 25) | (S[24 % 8] << 7))) + ((S[24 % 8] & (S[25 % 8] ^ S[26 % 8])) ^ S[26 % 8]) + W[44] + 0xd192e819;
	t1 = (((S[20 % 8] >> 2) | (S[20 % 8] << 30)) ^ ((S[20 % 8] >> 13) | (S[20 % 8] << 19)) ^ ((S[20 % 8] >> 22) | (S[20 % 8] << 10))) + ((S[20 % 8] & (S[21 % 8] | S[22 % 8])) | (S[21 % 8] & S[22 % 8]));
	S[23 % 8] += t0;
	S[27 % 8] = t0 + t1;
	t0 = S[26 % 8] + (((S[23 % 8] >> 6) | (S[23 % 8] << 26)) ^ ((S[23 % 8] >> 11) | (S[23 % 8] << 21)) ^ ((S[23 % 8] >> 25) | (S[23 % 8] << 7))) + ((S[23 % 8] & (S[24 % 8] ^ S[25 % 8])) ^ S[25 % 8]) + W[45] + 0xd6990624;
	t1 = (((S[19 % 8] >> 2) | (S[19 % 8] << 30)) ^ ((S[19 % 8] >> 13) | (S[19 % 8] << 19)) ^ ((S[19 % 8] >> 22) | (S[19 % 8] << 10))) + ((S[19 % 8] & (S[20 % 8] | S[21 % 8])) | (S[20 % 8] & S[21 % 8]));
	S[22 % 8] += t0;
	S[26 % 8] = t0 + t1;
	t0 = S[25 % 8] + (((S[22 % 8] >> 6) | (S[22 % 8] << 26)) ^ ((S[22 % 8] >> 11) | (S[22 % 8] << 21)) ^ ((S[22 % 8] >> 25) | (S[22 % 8] << 7))) + ((S[22 % 8] & (S[23 % 8] ^ S[24 % 8])) ^ S[24 % 8]) + W[46] + 0xf40e3585;
	t1 = (((S[18 % 8] >> 2) | (S[18 % 8] << 30)) ^ ((S[18 % 8] >> 13) | (S[18 % 8] << 19)) ^ ((S[18 % 8] >> 22) | (S[18 % 8] << 10))) + ((S[18 % 8] & (S[19 % 8] | S[20 % 8])) | (S[19 % 8] & S[20 % 8]));
	S[21 % 8] += t0;
	S[25 % 8] = t0 + t1;
	t0 = S[24 % 8] + (((S[21 % 8] >> 6) | (S[21 % 8] << 26)) ^ ((S[21 % 8] >> 11) | (S[21 % 8] << 21)) ^ ((S[21 % 8] >> 25) | (S[21 % 8] << 7))) + ((S[21 % 8] & (S[22 % 8] ^ S[23 % 8])) ^ S[23 % 8]) + W[47] + 0x106aa070;
	t1 = (((S[17 % 8] >> 2) | (S[17 % 8] << 30)) ^ ((S[17 % 8] >> 13) | (S[17 % 8] << 19)) ^ ((S[17 % 8] >> 22) | (S[17 % 8] << 10))) + ((S[17 % 8] & (S[18 % 8] | S[19 % 8])) | (S[18 % 8] & S[19 % 8]));
	S[20 % 8] += t0;
	S[24 % 8] = t0 + t1;
	t0 = S[23 % 8] + (((S[20 % 8] >> 6) | (S[20 % 8] << 26)) ^ ((S[20 % 8] >> 11) | (S[20 % 8] << 21)) ^ ((S[20 % 8] >> 25) | (S[20 % 8] << 7))) + ((S[20 % 8] & (S[21 % 8] ^ S[22 % 8])) ^ S[22 % 8]) + W[48] + 0x19a4c116;
	t1 = (((S[16 % 8] >> 2) | (S[16 % 8] << 30)) ^ ((S[16 % 8] >> 13) | (S[16 % 8] << 19)) ^ ((S[16 % 8] >> 22) | (S[16 % 8] << 10))) + ((S[16 % 8] & (S[17 % 8] | S[18 % 8])) | (S[17 % 8] & S[18 % 8]));
	S[19 % 8] += t0;
	S[23 % 8] = t0 + t1;
	t0 = S[22 % 8] + (((S[19 % 8] >> 6) | (S[19 % 8] << 26)) ^ ((S[19 % 8] >> 11) | (S[19 % 8] << 21)) ^ ((S[19 % 8] >> 25) | (S[19 % 8] << 7))) + ((S[19 % 8] & (S[20 % 8] ^ S[21 % 8])) ^ S[21 % 8]) + W[49] + 0x1e376c08;
	t1 = (((S[15 % 8] >> 2) | (S[15 % 8] << 30)) ^ ((S[15 % 8] >> 13) | (S[15 % 8] << 19)) ^ ((S[15 % 8] >> 22) | (S[15 % 8] << 10))) + ((S[15 % 8] & (S[16 % 8] | S[17 % 8])) | (S[16 % 8] & S[17 % 8]));
	S[18 % 8] += t0;
	S[22 % 8] = t0 + t1;
	t0 = S[21 % 8] + (((S[18 % 8] >> 6) | (S[18 % 8] << 26)) ^ ((S[18 % 8] >> 11) | (S[18 % 8] << 21)) ^ ((S[18 % 8] >> 25) | (S[18 % 8] << 7))) + ((S[18 % 8] & (S[19 % 8] ^ S[20 % 8])) ^ S[20 % 8]) + W[50] + 0x2748774c;
	t1 = (((S[14 % 8] >> 2) | (S[14 % 8] << 30)) ^ ((S[14 % 8] >> 13) | (S[14 % 8] << 19)) ^ ((S[14 % 8] >> 22) | (S[14 % 8] << 10))) + ((S[14 % 8] & (S[15 % 8] | S[16 % 8])) | (S[15 % 8] & S[16 % 8]));
	S[17 % 8] += t0;
	S[21 % 8] = t0 + t1;
	t0 = S[20 % 8] + (((S[17 % 8] >> 6) | (S[17 % 8] << 26)) ^ ((S[17 % 8] >> 11) | (S[17 % 8] << 21)) ^ ((S[17 % 8] >> 25) | (S[17 % 8] << 7))) + ((S[17 % 8] & (S[18 % 8] ^ S[19 % 8])) ^ S[19 % 8]) + W[51] + 0x34b0bcb5;
	t1 = (((S[13 % 8] >> 2) | (S[13 % 8] << 30)) ^ ((S[13 % 8] >> 13) | (S[13 % 8] << 19)) ^ ((S[13 % 8] >> 22) | (S[13 % 8] << 10))) + ((S[13 % 8] & (S[14 % 8] | S[15 % 8])) | (S[14 % 8] & S[15 % 8]));
	S[16 % 8] += t0;
	S[20 % 8] = t0 + t1;
	t0 = S[19 % 8] + (((S[16 % 8] >> 6) | (S[16 % 8] << 26)) ^ ((S[16 % 8] >> 11) | (S[16 % 8] << 21)) ^ ((S[16 % 8] >> 25) | (S[16 % 8] << 7))) + ((S[16 % 8] & (S[17 % 8] ^ S[18 % 8])) ^ S[18 % 8]) + W[52] + 0x391c0cb3;
	t1 = (((S[12 % 8] >> 2) | (S[12 % 8] << 30)) ^ ((S[12 % 8] >> 13) | (S[12 % 8] << 19)) ^ ((S[12 % 8] >> 22) | (S[12 % 8] << 10))) + ((S[12 % 8] & (S[13 % 8] | S[14 % 8])) | (S[13 % 8] & S[14 % 8]));
	S[15 % 8] += t0;
	S[19 % 8] = t0 + t1;
	t0 = S[18 % 8] + (((S[15 % 8] >> 6) | (S[15 % 8] << 26)) ^ ((S[15 % 8] >> 11) | (S[15 % 8] << 21)) ^ ((S[15 % 8] >> 25) | (S[15 % 8] << 7))) + ((S[15 % 8] & (S[16 % 8] ^ S[17 % 8])) ^ S[17 % 8]) + W[53] + 0x4ed8aa4a;
	t1 = (((S[11 % 8] >> 2) | (S[11 % 8] << 30)) ^ ((S[11 % 8] >> 13) | (S[11 % 8] << 19)) ^ ((S[11 % 8] >> 22) | (S[11 % 8] << 10))) + ((S[11 % 8] & (S[12 % 8] | S[13 % 8])) | (S[12 % 8] & S[13 % 8]));
	S[14 % 8] += t0;
	S[18 % 8] = t0 + t1;
	t0 = S[17 % 8] + (((S[14 % 8] >> 6) | (S[14 % 8] << 26)) ^ ((S[14 % 8] >> 11) | (S[14 % 8] << 21)) ^ ((S[14 % 8] >> 25) | (S[14 % 8] << 7))) + ((S[14 % 8] & (S[15 % 8] ^ S[16 % 8])) ^ S[16 % 8]) + W[54] + 0x5b9cca4f;
	t1 = (((S[10 % 8] >> 2) | (S[10 % 8] << 30)) ^ ((S[10 % 8] >> 13) | (S[10 % 8] << 19)) ^ ((S[10 % 8] >> 22) | (S[10 % 8] << 10))) + ((S[10 % 8] & (S[11 % 8] | S[12 % 8])) | (S[11 % 8] & S[12 % 8]));
	S[13 % 8] += t0;
	S[17 % 8] = t0 + t1;
	t0 = S[16 % 8] + (((S[13 % 8] >> 6) | (S[13 % 8] << 26)) ^ ((S[13 % 8] >> 11) | (S[13 % 8] << 21)) ^ ((S[13 % 8] >> 25) | (S[13 % 8] << 7))) + ((S[13 % 8] & (S[14 % 8] ^ S[15 % 8])) ^ S[15 % 8]) + W[55] + 0x682e6ff3;
	t1 = (((S[9 % 8] >> 2) | (S[9 % 8] << 30)) ^ ((S[9 % 8] >> 13) | (S[9 % 8] << 19)) ^ ((S[9 % 8] >> 22) | (S[9 % 8] << 10))) + ((S[9 % 8] & (S[10 % 8] | S[11 % 8])) | (S[10 % 8] & S[11 % 8]));
	S[12 % 8] += t0;
	S[16 % 8] = t0 + t1;
	t0 = S[15 % 8] + (((S[12 % 8] >> 6) | (S[12 % 8] << 26)) ^ ((S[12 % 8] >> 11) | (S[12 % 8] << 21)) ^ ((S[12 % 8] >> 25) | (S[12 % 8] << 7))) + ((S[12 % 8] & (S[13 % 8] ^ S[14 % 8])) ^ S[14 % 8]) + W[56] + 0x748f82ee;
	t1 = (((S[8 % 8] >> 2) | (S[8 % 8] << 30)) ^ ((S[8 % 8] >> 13) | (S[8 % 8] << 19)) ^ ((S[8 % 8] >> 22) | (S[8 % 8] << 10))) + ((S[8 % 8] & (S[9 % 8] | S[10 % 8])) | (S[9 % 8] & S[10 % 8]));
	S[11 % 8] += t0;
	S[15 % 8] = t0 + t1;
	t0 = S[14 % 8] + (((S[11 % 8] >> 6) | (S[11 % 8] << 26)) ^ ((S[11 % 8] >> 11) | (S[11 % 8] << 21)) ^ ((S[11 % 8] >> 25) | (S[11 % 8] << 7))) + ((S[11 % 8] & (S[12 % 8] ^ S[13 % 8])) ^ S[13 % 8]) + W[57] + 0x78a5636f;
	t1 = (((S[7 % 8] >> 2) | (S[7 % 8] << 30)) ^ ((S[7 % 8] >> 13) | (S[7 % 8] << 19)) ^ ((S[7 % 8] >> 22) | (S[7 % 8] << 10))) + ((S[7 % 8] & (S[8 % 8] | S[9 % 8])) | (S[8 % 8] & S[9 % 8]));
	S[10 % 8] += t0;
	S[14 % 8] = t0 + t1;
	t0 = S[13 % 8] + (((S[10 % 8] >> 6) | (S[10 % 8] << 26)) ^ ((S[10 % 8] >> 11) | (S[10 % 8] << 21)) ^ ((S[10 % 8] >> 25) | (S[10 % 8] << 7))) + ((S[10 % 8] & (S[11 % 8] ^ S[12 % 8])) ^ S[12 % 8]) + W[58] + 0x84c87814;
	t1 = (((S[6 % 8] >> 2) | (S[6 % 8] << 30)) ^ ((S[6 % 8] >> 13) | (S[6 % 8] << 19)) ^ ((S[6 % 8] >> 22) | (S[6 % 8] << 10))) + ((S[6 % 8] & (S[7 % 8] | S[8 % 8])) | (S[7 % 8] & S[8 % 8]));
	S[9 % 8] += t0;
	S[13 % 8] = t0 + t1;
	t0 = S[12 % 8] + (((S[9 % 8] >> 6) | (S[9 % 8] << 26)) ^ ((S[9 % 8] >> 11) | (S[9 % 8] << 21)) ^ ((S[9 % 8] >> 25) | (S[9 % 8] << 7))) + ((S[9 % 8] & (S[10 % 8] ^ S[11 % 8])) ^ S[11 % 8]) + W[59] + 0x8cc70208;
	t1 = (((S[5 % 8] >> 2) | (S[5 % 8] << 30)) ^ ((S[5 % 8] >> 13) | (S[5 % 8] << 19)) ^ ((S[5 % 8] >> 22) | (S[5 % 8] << 10))) + ((S[5 % 8] & (S[6 % 8] | S[7 % 8])) | (S[6 % 8] & S[7 % 8]));
	S[8 % 8] += t0;
	S[12 % 8] = t0 + t1;
	t0 = S[11 % 8] + (((S[8 % 8] >> 6) | (S[8 % 8] << 26)) ^ ((S[8 % 8] >> 11) | (S[8 % 8] << 21)) ^ ((S[8 % 8] >> 25) | (S[8 % 8] << 7))) + ((S[8 % 8] & (S[9 % 8] ^ S[10 % 8])) ^ S[10 % 8]) + W[60] + 0x90befffa;
	t1 = (((S[4 % 8] >> 2) | (S[4 % 8] << 30)) ^ ((S[4 % 8] >> 13) | (S[4 % 8] << 19)) ^ ((S[4 % 8] >> 22) | (S[4 % 8] << 10))) + ((S[4 % 8] & (S[5 % 8] | S[6 % 8])) | (S[5 % 8] & S[6 % 8]));
	S[7 % 8] += t0;
	S[11 % 8] = t0 + t1;
	t0 = S[10 % 8] + (((S[7 % 8] >> 6) | (S[7 % 8] << 26)) ^ ((S[7 % 8] >> 11) | (S[7 % 8] << 21)) ^ ((S[7 % 8] >> 25) | (S[7 % 8] << 7))) + ((S[7 % 8] & (S[8 % 8] ^ S[9 % 8])) ^ S[9 % 8]) + W[61] + 0xa4506ceb;
	t1 = (((S[3 % 8] >> 2) | (S[3 % 8] << 30)) ^ ((S[3 % 8] >> 13) | (S[3 % 8] << 19)) ^ ((S[3 % 8] >> 22) | (S[3 % 8] << 10))) + ((S[3 % 8] & (S[4 % 8] | S[5 % 8])) | (S[4 % 8] & S[5 % 8]));
	S[6 % 8] += t0;
	S[10 % 8] = t0 + t1;
	t0 = S[9 % 8] + (((S[6 % 8] >> 6) | (S[6 % 8] << 26)) ^ ((S[6 % 8] >> 11) | (S[6 % 8] << 21)) ^ ((S[6 % 8] >> 25) | (S[6 % 8] << 7))) + ((S[6 % 8] & (S[7 % 8] ^ S[8 % 8])) ^ S[8 % 8]) + W[62] + 0xbef9a3f7;
	t1 = (((S[2 % 8] >> 2) | (S[2 % 8] << 30)) ^ ((S[2 % 8] >> 13) | (S[2 % 8] << 19)) ^ ((S[2 % 8] >> 22) | (S[2 % 8] << 10))) + ((S[2 % 8] & (S[3 % 8] | S[4 % 8])) | (S[3 % 8] & S[4 % 8]));
	S[5 % 8] += t0;
	S[9 % 8] = t0 + t1;
	t0 = S[8 % 8] + (((S[5 % 8] >> 6) | (S[5 % 8] << 26)) ^ ((S[5 % 8] >> 11) | (S[5 % 8] << 21)) ^ ((S[5 % 8] >> 25) | (S[5 % 8] << 7))) + ((S[5 % 8] & (S[6 % 8] ^ S[7 % 8])) ^ S[7 % 8]) + W[63] + 0xc67178f2;
	t1 = (((S[1 % 8] >> 2) | (S[1 % 8] << 30)) ^ ((S[1 % 8] >> 13) | (S[1 % 8] << 19)) ^ ((S[1 % 8] >> 22) | (S[1 % 8] << 10))) + ((S[1 % 8] & (S[2 % 8] | S[3 % 8])) | (S[2 % 8] & S[3 % 8]));
	S[4 % 8] += t0;
	S[8 % 8] = t0 + t1;

	for (int i = 0; i < 8; i++)
	{
		state[i] += S[i];
	}

	be32enc(digest, state, 8);
}

